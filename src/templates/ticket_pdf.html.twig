<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <style>
        body {
            font-family: "Helvetica Neue", Arial, sans-serif;
            font-size: 12px;
            color: #333;
            margin: 20px;
        }
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 2px solid #444;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        .company {
            font-size: 14px;
            line-height: 1.5;
        }
        .doc-box {
            border: 2px solid #444;
            padding: 8px 12px;
            text-align: center;
            font-size: 14px;
            font-weight: bold;
        }
        .section-title {
            font-weight: bold;
            margin: 12px 0 6px 0;
            font-size: 13px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 12px;
        }
        th {
            background: #f0f0f0;
            text-align: left;
            padding: 6px;
            font-size: 12px;
            border: 1px solid #ddd;
        }
        td {
            padding: 6px;
            border: 1px solid #ddd;
            font-size: 12px;
        }
        .totals {
            width: 40%;
            margin-left: auto;
            border: none;
        }
        .totals td {
            border: none;
            padding: 4px 6px;
        }
        .totals .label {
            text-align: right;
            font-weight: bold;
        }
        .totals .value {
            text-align: right;
        }
        .footer {
            margin-top: 20px;
            font-size: 11px;
            color: #555;
        }
        .qr {
            margin-top: 10px;
        }
    </style>
</head>
<body>
    {% set cp = doc.company %}
    {% set cl = doc.client %}
    {% set moneda = doc.tipoMoneda|catalog('02') %}
    {% set name = doc.tipoDoc|catalog('01') %}

    <!-- CABECERA -->
    <div class="header">
        <div class="company">
            <img src="{{ params.system.logo|image_b64 }}" height="60"><br>
            <strong>{{ cp.razonSocial }}</strong><br>
            RUC: {{ cp.ruc }}<br>
            {{ cp.address.direccion }}<br>
            {% if params.user.header is defined %}{{ params.user.header|raw }}{% endif %}
        </div>
        <div class="doc-box">
            {{ name }} ELECTRÓNICA<br>
            {{ doc.serie }} - {{ doc.correlativo }}
        </div>
    </div>

    <!-- CLIENTE -->
    <div class="section-title">Datos del Cliente</div>
    <table>
        <tr>
            <td><strong>Cliente:</strong> {{ cl.rznSocial }}</td>
            <td><strong>{{ cl.tipoDoc|catalog('06') }}:</strong> {{ cl.numDoc }}</td>
        </tr>
        <tr>
            <td><strong>Dirección:</strong> {% if cl.address %}{{ cl.address.direccion }}{% endif %}</td>
            <td><strong>Fecha Emisión:</strong> {{ doc.fechaEmision|date('d/m/Y H:i') }}</td>
        </tr>
    </table>

    <!-- DETALLE -->
    <div class="section-title">Detalle de la Venta</div>
    <table>
        <thead>
            <tr>
                <th>Cant</th>
                <th>Descripción</th>
                <th>Valor Unit.</th>
                <th>Total</th>
            </tr>
        </thead>
        <tbody>
            {% for det in doc.details %}
            <tr>
                <td>{{ det.cantidad|n_format }}</td>
                <td>{{ det.descripcion }}</td>
                <td class="right">{{ moneda }} {{ det.mtoValorUnitario|n_format }}</td>
                <td class="right">{{ moneda }} {{ det.mtoValorVenta|n_format }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <!-- TOTALES -->
    <table class="totals">
        {% if doc.mtoOperGravadas %}
        <tr>
            <td class="label">Op. Gravadas:</td>
            <td class="value">{{ moneda }} {{ doc.mtoOperGravadas|n_format }}</td>
        </tr>
        {% endif %}
        {% if doc.mtoOperExoneradas %}
        <tr>
            <td class="label">Op. Exoneradas:</td>
            <td class="value">{{ moneda }} {{ doc.mtoOperExoneradas|n_format }}</td>
        </tr>
        {% endif %}
        <tr>
            <td class="label">IGV (18%):</td>
            <td class="value">{{ moneda }} {{ doc.mtoIGV|n_format }}</td>
        </tr>
        <tr>
            <td class="label"><strong>Total:</strong></td>
            <td class="value"><strong>{{ moneda }} {{ doc.mtoImpVenta|n_format }}</strong></td>
        </tr>
    </table>

    <!-- LEYENDA -->
    <div><strong>SON:</strong> {{ legend(doc.legends, '1000') }}</div>

    <!-- FOOTER -->
    <div class="footer">
        {% if params.system.hash is defined and params.system.hash %}
            <div><strong>Hash:</strong> {{ params.system.hash }}</div>
        {% endif %}
        <div>
            <img class="qr" src="{{ qrCode(doc)|image_b64('svg+xml') }}" width="120"><br>
        </div>
        <div>¡Gracias por su compra!</div>
        <div>Representación impresa de la {{ name }} ELECTRÓNICA</div>
    </div>
</body>
</html>

